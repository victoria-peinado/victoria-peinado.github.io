import{r as e,n as q,x as h,h as b,f as w,q as j,a as k,j as p}from"./index-Di-Zw_TF.js";function M(t){const[o,u]=e.useState(null),[l,n]=e.useState(!0),[f,c]=e.useState(null);return e.useEffect(()=>{if(!t){n(!1),u(null);return}console.log(`Setting up listener for game: ${t}`),n(!0);const s=q(b,"gameSessions",t),d=h(s,r=>{if(r.exists()){const i={id:r.id,...r.data()};u(i),c(null)}else u(null),c("Game session not found");n(!1)},r=>{console.error("Error listening to game session:",r),c(r.message),n(!1)});return()=>{console.log("Cleaning up game session listener"),d()}},[t]),{gameSession:o,loading:l,error:f}}function _(t){const[o,u]=e.useState([]),[l,n]=e.useState(!0),[f,c]=e.useState(null);return e.useEffect(()=>{if(!t){n(!1),u([]);return}n(!0);const s=w(b,`questionBanks/${t}/questions`),d=j(s),r=h(d,i=>{const x=i.docs.map(m=>({id:m.id,...m.data()}));u(x),n(!1)},i=>{console.error("Error fetching questions:",i),c("Failed to load questions for this bank."),n(!1)});return()=>r()},[t]),{questions:o,loading:l,error:f}}function $({startTime:t,duration:o,onExpire:u}){const[l,n]=e.useState(o),{playSound:f,stopSound:c}=k(),s=e.useRef(!1),d=e.useRef(u),r=e.useRef(f),i=e.useRef(c);e.useEffect(()=>{d.current=u},[u]),e.useEffect(()=>{r.current=f,i.current=c},[f,c]),e.useEffect(()=>{if(!t)return;const a=()=>{const g=Date.now(),R=t.toMillis?t.toMillis():t,E=(g-R)/1e3,v=Math.max(0,o-E);return Math.floor(v)};n(a()),s.current=!1;const S=setInterval(()=>{const g=a();n(g),g<=5&&g>=1&&(s.current||(r.current("timer_tick",{loop:!0}),s.current=!0)),g>5&&s.current&&(i.current("timer_tick"),s.current=!1),g<=0&&(s.current&&(i.current("timer_tick"),s.current=!1),d.current&&d.current(),r.current("times_up"),clearInterval(S))},100);return()=>{clearInterval(S),s.current&&(i.current("timer_tick"),s.current=!1)}},[t,o]);const x=()=>{const a=l/o*100;return a>50?"text-primary-light":a>20?"text-yellow-400":"text-secondary"},m=()=>{const a=l/o*100;return a>50?"bg-primary":a>20?"bg-yellow-500":"bg-secondary"},y=l/o*100;return p.jsxs("div",{className:"w-full",children:[p.jsxs("div",{className:`text-4xl font-display font-bold text-center mb-2 ${x()}`,children:[l,"s"]}),p.jsx("div",{className:"w-full bg-neutral-700 rounded-full h-4 overflow-hidden",children:p.jsx("div",{className:`h-full ${m()} transition-all duration-100`,style:{width:`${y}%`}})})]})}export{$ as T,_ as a,M as u};
