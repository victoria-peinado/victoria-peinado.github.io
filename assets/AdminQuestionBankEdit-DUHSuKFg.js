import{g as Fe,f as Ce,h as he,q as Le,G as Te,i as Ie,Q as Be,n as je,v as Oe,S as Me,p as Qe,T as Ue,d as ze,r as J,j as r,C as be,k as ke,l as Se,B as fe,u as Pe,L as $e,y as qe}from"./index-Di-Zw_TF.js";import{a as Ke}from"./bankManagement-zhANBKmn.js";import{C as We}from"./ConfirmModal-BQmpQ8Rz.js";import{I as Ee}from"./Input-BKMhVuRP.js";import{L as xe}from"./Label-B4QQdoiM.js";import{S as He}from"./Select-ynW37uQh.js";var ye={exports:{}};var Ve=ye.exports,Ae;function Je(){return Ae||(Ae=1,(function(m,u){((p,n)=>{m.exports=n()})(Ve,function p(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},y,w=!n.document&&!!n.postMessage,L=n.IS_PAPA_WORKER||!1,B={},F=0,a={};function g(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(t){var s=ve(t);s.chunkSize=parseInt(s.chunkSize),t.step||t.chunk||(s.chunkSize=null),this._handle=new G(s),(this._handle.streamer=this)._config=s}).call(this,e),this.parseChunk=function(t,s){var o=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<o){let x=this._config.newline;x||(i=this._config.quoteChar||'"',x=this._handle.guessLineEndings(t,i)),t=[...t.split(x).slice(o)].join(x)}this.isFirstChunk&&S(this._config.beforeFirstChunk)&&(i=this._config.beforeFirstChunk(t))!==void 0&&(t=i),this.isFirstChunk=!1,this._halted=!1;var o=this._partialLine+t,i=(this._partialLine="",this._handle.parse(o,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(t=i.meta.cursor,o=(this._finished||(this._partialLine=o.substring(t-this._baseIndex),this._baseIndex=t),i&&i.data&&(this._rowCount+=i.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),L)n.postMessage({results:i,workerId:a.WORKER_ID,finished:o});else if(S(this._config.chunk)&&!s){if(this._config.chunk(i,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=i=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(i.data),this._completeResults.errors=this._completeResults.errors.concat(i.errors),this._completeResults.meta=i.meta),this._completed||!o||!S(this._config.complete)||i&&i.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),o||i&&i.meta.paused||this._nextChunk(),i}this._halted=!0},this._sendError=function(t){S(this._config.error)?this._config.error(t):L&&this._config.error&&n.postMessage({workerId:a.WORKER_ID,error:t,finished:!1})}}function C(e){var t;(e=e||{}).chunkSize||(e.chunkSize=a.RemoteChunkSize),g.call(this,e),this._nextChunk=w?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(s){this._input=s,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),w||(t.onload=oe(this._chunkLoaded,this),t.onerror=oe(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!w),this._config.downloadRequestHeaders){var s,o=this._config.downloadRequestHeaders;for(s in o)t.setRequestHeader(s,o[s])}var i;this._config.chunkSize&&(i=this._start+this._config.chunkSize-1,t.setRequestHeader("Range","bytes="+this._start+"-"+i));try{t.send(this._config.downloadRequestBody)}catch(x){this._chunkError(x.message)}w&&t.status===0&&this._chunkError()}},this._chunkLoaded=function(){t.readyState===4&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize||t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(s=>(s=s.getResponseHeader("Content-Range"))!==null?parseInt(s.substring(s.lastIndexOf("/")+1)):-1)(t),this.parseChunk(t.responseText)))},this._chunkError=function(s){s=t.statusText||s,this._sendError(new Error(s))}}function q(e){(e=e||{}).chunkSize||(e.chunkSize=a.LocalChunkSize),g.call(this,e);var t,s,o=typeof FileReader<"u";this.stream=function(i){this._input=i,s=i.slice||i.webkitSlice||i.mozSlice,o?((t=new FileReader).onload=oe(this._chunkLoaded,this),t.onerror=oe(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var i=this._input,x=(this._config.chunkSize&&(x=Math.min(this._start+this._config.chunkSize,this._input.size),i=s.call(i,this._start,x)),t.readAsText(i,this._config.encoding));o||this._chunkLoaded({target:{result:x}})},this._chunkLoaded=function(i){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(i.target.result)},this._chunkError=function(){this._sendError(t.error)}}function T(e){var t;g.call(this,e=e||{}),this.stream=function(s){return t=s,this._nextChunk()},this._nextChunk=function(){var s,o;if(!this._finished)return s=this._config.chunkSize,t=s?(o=t.substring(0,s),t.substring(s)):(o=t,""),this._finished=!t,this.parseChunk(o)}}function z(e){g.call(this,e=e||{});var t=[],s=!0,o=!1;this.pause=function(){g.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){g.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(i){this._input=i,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){o&&t.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):s=!0},this._streamData=oe(function(i){try{t.push(typeof i=="string"?i:i.toString(this._config.encoding)),s&&(s=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(x){this._streamError(x)}},this),this._streamError=oe(function(i){this._streamCleanUp(),this._sendError(i)},this),this._streamEnd=oe(function(){this._streamCleanUp(),o=!0,this._streamData("")},this),this._streamCleanUp=oe(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function G(e){var t,s,o,i,x=Math.pow(2,53),M=-x,Z=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,Y=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,_=this,A=0,d=0,W=!1,h=!1,b=[],l={data:[],errors:[],meta:{}};function Q(k){return e.skipEmptyLines==="greedy"?k.join("").trim()==="":k.length===1&&k[0].length===0}function I(){if(l&&o&&(X("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+a.DefaultDelimiter+"'"),o=!1),e.skipEmptyLines&&(l.data=l.data.filter(function(c){return!Q(c)})),K()){let c=function(N,U){S(e.transformHeader)&&(N=e.transformHeader(N,U)),b.push(N)};if(l)if(Array.isArray(l.data[0])){for(var k=0;K()&&k<l.data.length;k++)l.data[k].forEach(c);l.data.splice(0,1)}else l.data.forEach(c)}function E(c,N){for(var U=e.header?{}:[],j=0;j<c.length;j++){var R=j,v=c[j],v=((te,f)=>(D=>(e.dynamicTypingFunction&&e.dynamicTyping[D]===void 0&&(e.dynamicTyping[D]=e.dynamicTypingFunction(D)),(e.dynamicTyping[D]||e.dynamicTyping)===!0))(te)?f==="true"||f==="TRUE"||f!=="false"&&f!=="FALSE"&&((D=>{if(Z.test(D)&&(D=parseFloat(D),M<D&&D<x))return 1})(f)?parseFloat(f):Y.test(f)?new Date(f):f===""?null:f):f)(R=e.header?j>=b.length?"__parsed_extra":b[j]:R,v=e.transform?e.transform(v,R):v);R==="__parsed_extra"?(U[R]=U[R]||[],U[R].push(v)):U[R]=v}return e.header&&(j>b.length?X("FieldMismatch","TooManyFields","Too many fields: expected "+b.length+" fields but parsed "+j,d+N):j<b.length&&X("FieldMismatch","TooFewFields","Too few fields: expected "+b.length+" fields but parsed "+j,d+N)),U}var O;l&&(e.header||e.dynamicTyping||e.transform)&&(O=1,!l.data.length||Array.isArray(l.data[0])?(l.data=l.data.map(E),O=l.data.length):l.data=E(l.data,0),e.header&&l.meta&&(l.meta.fields=b),d+=O)}function K(){return e.header&&b.length===0}function X(k,E,O,c){k={type:k,code:E,message:O},c!==void 0&&(k.row=c),l.errors.push(k)}S(e.step)&&(i=e.step,e.step=function(k){l=k,K()?I():(I(),l.data.length!==0&&(A+=k.data.length,e.preview&&A>e.preview?s.abort():(l.data=l.data[0],i(l,_))))}),this.parse=function(k,E,O){var c=e.quoteChar||'"',c=(e.newline||(e.newline=this.guessLineEndings(k,c)),o=!1,e.delimiter?S(e.delimiter)&&(e.delimiter=e.delimiter(k),l.meta.delimiter=e.delimiter):((c=((N,U,j,R,v)=>{var te,f,D,le;v=v||[",","	","|",";",a.RECORD_SEP,a.UNIT_SEP];for(var de=0;de<v.length;de++){for(var re,pe=v[de],H=0,ne=0,P=0,V=(D=void 0,new $({comments:R,delimiter:pe,newline:U,preview:10}).parse(N)),ae=0;ae<V.data.length;ae++)j&&Q(V.data[ae])?P++:(re=V.data[ae].length,ne+=re,D===void 0?D=re:0<re&&(H+=Math.abs(re-D),D=re));0<V.data.length&&(ne/=V.data.length-P),(f===void 0||H<=f)&&(le===void 0||le<ne)&&1.99<ne&&(f=H,te=pe,le=ne)}return{successful:!!(e.delimiter=te),bestDelimiter:te}})(k,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess)).successful?e.delimiter=c.bestDelimiter:(o=!0,e.delimiter=a.DefaultDelimiter),l.meta.delimiter=e.delimiter),ve(e));return e.preview&&e.header&&c.preview++,t=k,s=new $(c),l=s.parse(t,E,O),I(),W?{meta:{paused:!0}}:l||{meta:{paused:!1}}},this.paused=function(){return W},this.pause=function(){W=!0,s.abort(),t=S(e.chunk)?"":t.substring(s.getCharIndex())},this.resume=function(){_.streamer._halted?(W=!1,_.streamer.parseChunk(t,!0)):setTimeout(_.resume,3)},this.aborted=function(){return h},this.abort=function(){h=!0,s.abort(),l.meta.aborted=!0,S(e.complete)&&e.complete(l),t=""},this.guessLineEndings=function(N,c){N=N.substring(0,1048576);var c=new RegExp(se(c)+"([^]*?)"+se(c),"gm"),O=(N=N.replace(c,"")).split("\r"),c=N.split(`
`),N=1<c.length&&c[0].length<O[0].length;if(O.length===1||N)return`
`;for(var U=0,j=0;j<O.length;j++)O[j][0]===`
`&&U++;return U>=O.length/2?`\r
`:"\r"}}function se(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function $(e){var t=(e=e||{}).delimiter,s=e.newline,o=e.comments,i=e.step,x=e.preview,M=e.fastMode,Z=null,Y=!1,_=e.quoteChar==null?'"':e.quoteChar,A=_;if(e.escapeChar!==void 0&&(A=e.escapeChar),(typeof t!="string"||-1<a.BAD_DELIMITERS.indexOf(t))&&(t=","),o===t)throw new Error("Comment character same as delimiter");o===!0?o="#":(typeof o!="string"||-1<a.BAD_DELIMITERS.indexOf(o))&&(o=!1),s!==`
`&&s!=="\r"&&s!==`\r
`&&(s=`
`);var d=0,W=!1;this.parse=function(h,b,l){if(typeof h!="string")throw new Error("Input must be a string");var Q=h.length,I=t.length,K=s.length,X=o.length,k=S(i),E=[],O=[],c=[],N=d=0;if(!h)return H();if(M||M!==!1&&h.indexOf(_)===-1){for(var U=h.split(s),j=0;j<U.length;j++){if(c=U[j],d+=c.length,j!==U.length-1)d+=s.length;else if(l)return H();if(!o||c.substring(0,X)!==o){if(k){if(E=[],le(c.split(t)),ne(),W)return H()}else le(c.split(t));if(x&&x<=j)return E=E.slice(0,x),H(!0)}}return H()}for(var R=h.indexOf(t,d),v=h.indexOf(s,d),te=new RegExp(se(A)+se(_),"g"),f=h.indexOf(_,d);;)if(h[d]===_)for(f=d,d++;;){if((f=h.indexOf(_,f+1))===-1)return l||O.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:E.length,index:d}),re();if(f===Q-1)return re(h.substring(d,f).replace(te,_));if(_===A&&h[f+1]===A)f++;else if(_===A||f===0||h[f-1]!==A){R!==-1&&R<f+1&&(R=h.indexOf(t,f+1));var D=de((v=v!==-1&&v<f+1?h.indexOf(s,f+1):v)===-1?R:Math.min(R,v));if(h.substr(f+1+D,I)===t){c.push(h.substring(d,f).replace(te,_)),h[d=f+1+D+I]!==_&&(f=h.indexOf(_,d)),R=h.indexOf(t,d),v=h.indexOf(s,d);break}if(D=de(v),h.substring(f+1+D,f+1+D+K)===s){if(c.push(h.substring(d,f).replace(te,_)),pe(f+1+D+K),R=h.indexOf(t,d),f=h.indexOf(_,d),k&&(ne(),W))return H();if(x&&E.length>=x)return H(!0);break}O.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:E.length,index:d}),f++}}else if(o&&c.length===0&&h.substring(d,d+X)===o){if(v===-1)return H();d=v+K,v=h.indexOf(s,d),R=h.indexOf(t,d)}else if(R!==-1&&(R<v||v===-1))c.push(h.substring(d,R)),d=R+I,R=h.indexOf(t,d);else{if(v===-1)break;if(c.push(h.substring(d,v)),pe(v+K),k&&(ne(),W))return H();if(x&&E.length>=x)return H(!0)}return re();function le(P){E.push(P),N=d}function de(P){var V=0;return V=P!==-1&&(P=h.substring(f+1,P))&&P.trim()===""?P.length:V}function re(P){return l||(P===void 0&&(P=h.substring(d)),c.push(P),d=Q,le(c),k&&ne()),H()}function pe(P){d=P,le(c),c=[],v=h.indexOf(s,d)}function H(P){if(e.header&&!b&&E.length&&!Y){var V=E[0],ae=Object.create(null),we=new Set(V);let Re=!1;for(let ce=0;ce<V.length;ce++){let ie=V[ce];if(ae[ie=S(e.transformHeader)?e.transformHeader(ie,ce):ie]){let me,De=ae[ie];for(;me=ie+"_"+De,De++,we.has(me););we.add(me),V[ce]=me,ae[ie]++,Re=!0,(Z=Z===null?{}:Z)[me]=ie}else ae[ie]=1,V[ce]=ie;we.add(ie)}Re&&console.warn("Duplicate headers found and renamed."),Y=!0}return{data:E,errors:O,meta:{delimiter:t,linebreak:s,aborted:W,truncated:!!P,cursor:N+(b||0),renamedHeaders:Z}}}function ne(){i(H()),E=[],O=[]}},this.abort=function(){W=!0},this.getCharIndex=function(){return d}}function ue(e){var t=e.data,s=B[t.workerId],o=!1;if(t.error)s.userError(t.error,t.file);else if(t.results&&t.results.data){var i={abort:function(){o=!0,ee(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:ge,resume:ge};if(S(s.userStep)){for(var x=0;x<t.results.data.length&&(s.userStep({data:t.results.data[x],errors:t.results.errors,meta:t.results.meta},i),!o);x++);delete t.results}else S(s.userChunk)&&(s.userChunk(t.results,i,t.file),delete t.results)}t.finished&&!o&&ee(t.workerId,t.results)}function ee(e,t){var s=B[e];S(s.userComplete)&&s.userComplete(t),s.terminate(),delete B[e]}function ge(){throw new Error("Not implemented.")}function ve(e){if(typeof e!="object"||e===null)return e;var t,s=Array.isArray(e)?[]:{};for(t in e)s[t]=ve(e[t]);return s}function oe(e,t){return function(){e.apply(t,arguments)}}function S(e){return typeof e=="function"}return a.parse=function(e,t){var s=(t=t||{}).dynamicTyping||!1;if(S(s)&&(t.dynamicTypingFunction=s,s={}),t.dynamicTyping=s,t.transform=!!S(t.transform)&&t.transform,!t.worker||!a.WORKERS_SUPPORTED)return s=null,a.NODE_STREAM_INPUT,typeof e=="string"?(e=(o=>o.charCodeAt(0)!==65279?o:o.slice(1))(e),s=new(t.download?C:T)(t)):e.readable===!0&&S(e.read)&&S(e.on)?s=new z(t):(n.File&&e instanceof File||e instanceof Object)&&(s=new q(t)),s.stream(e);(s=(()=>{var o;return!!a.WORKERS_SUPPORTED&&(o=(()=>{var i=n.URL||n.webkitURL||null,x=p.toString();return a.BLOB_URL||(a.BLOB_URL=i.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",x,")();"],{type:"text/javascript"})))})(),(o=new n.Worker(o)).onmessage=ue,o.id=F++,B[o.id]=o)})()).userStep=t.step,s.userChunk=t.chunk,s.userComplete=t.complete,s.userError=t.error,t.step=S(t.step),t.chunk=S(t.chunk),t.complete=S(t.complete),t.error=S(t.error),delete t.worker,s.postMessage({input:e,config:t,workerId:s.id})},a.unparse=function(e,t){var s=!1,o=!0,i=",",x=`\r
`,M='"',Z=M+M,Y=!1,_=null,A=!1,d=((()=>{if(typeof t=="object"){if(typeof t.delimiter!="string"||a.BAD_DELIMITERS.filter(function(b){return t.delimiter.indexOf(b)!==-1}).length||(i=t.delimiter),typeof t.quotes!="boolean"&&typeof t.quotes!="function"&&!Array.isArray(t.quotes)||(s=t.quotes),typeof t.skipEmptyLines!="boolean"&&typeof t.skipEmptyLines!="string"||(Y=t.skipEmptyLines),typeof t.newline=="string"&&(x=t.newline),typeof t.quoteChar=="string"&&(M=t.quoteChar),typeof t.header=="boolean"&&(o=t.header),Array.isArray(t.columns)){if(t.columns.length===0)throw new Error("Option columns is empty");_=t.columns}t.escapeChar!==void 0&&(Z=t.escapeChar+M),t.escapeFormulae instanceof RegExp?A=t.escapeFormulae:typeof t.escapeFormulae=="boolean"&&t.escapeFormulae&&(A=/^[=+\-@\t\r].*$/)}})(),new RegExp(se(M),"g"));if(typeof e=="string"&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return W(null,e,Y);if(typeof e[0]=="object")return W(_||Object.keys(e[0]),e,Y)}else if(typeof e=="object")return typeof e.data=="string"&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||_),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:typeof e.data[0]=="object"?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||typeof e.data[0]=="object"||(e.data=[e.data])),W(e.fields||[],e.data||[],Y);throw new Error("Unable to serialize unrecognized input");function W(b,l,Q){var I="",K=(typeof b=="string"&&(b=JSON.parse(b)),typeof l=="string"&&(l=JSON.parse(l)),Array.isArray(b)&&0<b.length),X=!Array.isArray(l[0]);if(K&&o){for(var k=0;k<b.length;k++)0<k&&(I+=i),I+=h(b[k],k);0<l.length&&(I+=x)}for(var E=0;E<l.length;E++){var O=(K?b:l[E]).length,c=!1,N=K?Object.keys(l[E]).length===0:l[E].length===0;if(Q&&!K&&(c=Q==="greedy"?l[E].join("").trim()==="":l[E].length===1&&l[E][0].length===0),Q==="greedy"&&K){for(var U=[],j=0;j<O;j++){var R=X?b[j]:j;U.push(l[E][R])}c=U.join("").trim()===""}if(!c){for(var v=0;v<O;v++){0<v&&!N&&(I+=i);var te=K&&X?b[v]:v;I+=h(l[E][te],v)}E<l.length-1&&(!Q||0<O&&!N)&&(I+=x)}}return I}function h(b,l){var Q,I;return b==null?"":b.constructor===Date?JSON.stringify(b).slice(1,25):(I=!1,A&&typeof b=="string"&&A.test(b)&&(b="'"+b,I=!0),Q=b.toString().replace(d,Z),(I=I||s===!0||typeof s=="function"&&s(b,l)||Array.isArray(s)&&s[l]||((K,X)=>{for(var k=0;k<X.length;k++)if(-1<K.indexOf(X[k]))return!0;return!1})(Q,a.BAD_DELIMITERS)||-1<Q.indexOf(i)||Q.charAt(0)===" "||Q.charAt(Q.length-1)===" ")?M+Q+M:Q)}},a.RECORD_SEP="",a.UNIT_SEP="",a.BYTE_ORDER_MARK="\uFEFF",a.BAD_DELIMITERS=["\r",`
`,'"',a.BYTE_ORDER_MARK],a.WORKERS_SUPPORTED=!w&&!!n.Worker,a.NODE_STREAM_INPUT=1,a.LocalChunkSize=10485760,a.RemoteChunkSize=5242880,a.DefaultDelimiter=",",a.Parser=$,a.ParserHandle=G,a.NetworkStreamer=C,a.FileStreamer=q,a.StringStreamer=T,a.ReadableStreamStreamer=z,n.jQuery&&((y=n.jQuery).fn.parse=function(e){var t=e.config||{},s=[];return this.each(function(x){if(!(y(this).prop("tagName").toUpperCase()==="INPUT"&&y(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var M=0;M<this.files.length;M++)s.push({file:this.files[M],inputElem:this,instanceConfig:y.extend({},t)})}),o(),this;function o(){if(s.length===0)S(e.complete)&&e.complete();else{var x,M,Z,Y,_=s[0];if(S(e.before)){var A=e.before(_.file,_.inputElem);if(typeof A=="object"){if(A.action==="abort")return x="AbortError",M=_.file,Z=_.inputElem,Y=A.reason,void(S(e.error)&&e.error({name:x},M,Z,Y));if(A.action==="skip")return void i();typeof A.config=="object"&&(_.instanceConfig=y.extend(_.instanceConfig,A.config))}else if(A==="skip")return void i()}var d=_.instanceConfig.complete;_.instanceConfig.complete=function(W){S(d)&&d(W,_.file,_.inputElem),i()},a.parse(_.file,_.instanceConfig)}}function i(){s.splice(0,1),o()}}),L&&(n.onmessage=function(e){e=e.data,a.WORKER_ID===void 0&&e&&(a.WORKER_ID=e.workerId),typeof e.input=="string"?n.postMessage({workerId:a.WORKER_ID,results:a.parse(e.input,e.config),finished:!0}):(n.File&&e.input instanceof File||e.input instanceof Object)&&(e=a.parse(e.input,e.config))&&n.postMessage({workerId:a.WORKER_ID,results:e,finished:!0})}),(C.prototype=Object.create(g.prototype)).constructor=C,(q.prototype=Object.create(g.prototype)).constructor=q,(T.prototype=Object.create(T.prototype)).constructor=T,(z.prototype=Object.create(g.prototype)).constructor=z,a})})(ye)),ye.exports}var Ge=Je();const Ze=Fe(Ge);async function Ye(m,u){return new Promise((p,n)=>{Ze.parse(m,{header:!0,delimiter:";",skipEmptyLines:!0,complete:async y=>{try{const w=y.data;if(w.length===0)throw new Error("CSV file is empty");const L=["question","answerA","answerB","answerC","answerD","correctLetter","duration"],B=Object.keys(w[0]),F=L.filter(C=>!B.includes(C));if(F.length>0)throw new Error(`Missing required columns: ${F.join(", ")}`);const a=Be(he),g=Ce(he,`questionBanks/${u}/questions`);w.forEach((C,q)=>{const T=parseInt(C.duration);(isNaN(T)||T<=0)&&console.warn(`Question ${q+1}: Invalid duration "${C.duration}", defaulting to 30 seconds`);const z=je(g);a.set(z,{question:C.question.trim(),answers:[{letter:"A",text:C.answerA.trim()},{letter:"B",text:C.answerB.trim()},{letter:"C",text:C.answerC.trim()},{letter:"D",text:C.answerD.trim()}],correctLetter:C.correctLetter.toUpperCase().trim(),duration:isNaN(T)?30:T,createdAt:Oe()})}),await a.commit(),console.log(`Successfully uploaded ${w.length} questions`),p(w.length)}catch(w){console.error("Error uploading CSV:",w),n(w)}},error:y=>{console.error("Error parsing CSV:",y),n(new Error("Failed to parse CSV file"))}})})}async function Xe(m,u){try{const p=Ce(he,`questionBanks/${m}/questions`);return(await Ue(p,{...u,createdAt:Oe()})).id}catch(p){throw console.error(`Error adding question to bank ${m}:`,p),new Error("Failed to add question.")}}async function et(m,u,p){try{const n=je(he,`questionBanks/${m}/questions`,u);await Qe(n,p)}catch(n){throw console.error(`Error updating question ${u}:`,n),new Error("Failed to update question.")}}async function tt(m,u){try{const p=je(he,`questionBanks/${m}/questions`,u);await Me(p)}catch(p){throw console.error(`Error deleting question ${u}:`,p),new Error("Failed to delete question.")}}async function st(m){try{const u=Ce(he,`questionBanks/${m}/questions`),p=Le(u,Te("createdAt","desc"));return(await Ie(p)).docs.map(y=>({id:y.id,...y.data()}))}catch(u){throw console.error(`Error fetching questions for bank ${m}:`,u),new Error("Failed to fetch questions.")}}function rt({handleMessage:m}){const{bankId:u}=ze(),[p,n]=J.useState(null),[y,w]=J.useState([]),[L,B]=J.useState(!0),[F,a]=J.useState(!1),[g,C]=J.useState(null),q=J.useCallback(async()=>{try{B(!0);const $=await Ke(u),ue=await st(u);n($),w(ue)}catch($){m($.message,"error")}finally{B(!1)}},[u,m]);J.useEffect(()=>{q()},[q]);const T=$=>{C($),a(!0)},z=()=>{C(null),a(!1)};return{bankId:u,bank:p,questions:y,loading:L,loadData:q,isDeleteModalOpen:F,questionToDelete:g,openDeleteModal:T,closeDeleteModal:z,handleDeleteConfirm:async()=>{if(g)try{await tt(u,g.id),m("Question deleted","success"),w(y.filter($=>$.id!==g.id))}catch($){m($.message,"error")}finally{z()}},handleUploadSuccess:()=>{m("CSV uploaded successfully! Refreshing questions...","success"),q()}}}const _e={question:"",answers:[{letter:"A",text:""},{letter:"B",text:""},{letter:"C",text:""},{letter:"D",text:""}],correctLetter:"A",duration:30,id:null};function nt({bankId:m,handleMessage:u,onFormSuccess:p}){const[n,y]=J.useState(_e),[w,L]=J.useState(!1),[B,F]=J.useState(_e),a=async T=>{T.preventDefault();const{question:z,answers:G,correctLetter:se,duration:$}=n;if(!z||G.some(ee=>!ee.text)){u("Please fill out all fields for the new question","error");return}const ue={question:z.trim(),answers:G.map(ee=>({...ee,text:ee.text.trim()})),correctLetter:se,duration:parseInt($,10)};try{await Xe(m,ue),u("Question added successfully!","success"),y(_e),p()}catch(ee){u(ee.message,"error")}},g=T=>{F(T),L(!0)},C=()=>{L(!1),F(_e)};return{addFormState:n,setAddFormState:y,handleAddQuestion:a,isEditModalOpen:w,editFormState:B,setEditFormState:F,openEditModal:g,closeEditModal:C,handleUpdateQuestion:async T=>{T.preventDefault();try{const{id:z,...G}=B;G.duration=parseInt(G.duration,10),await et(m,z,G),u("Question updated successfully!","success"),C(),p()}catch(z){u(z.message,"error")}}}}function it(){const[m,u]=J.useState({text:"",type:""}),p=J.useCallback((w,L,B=4e3)=>{u({text:w,type:L}),setTimeout(()=>u({text:"",type:""}),B)},[]),n=rt({handleMessage:p}),y=nt({handleMessage:p,bankId:n.bankId,onFormSuccess:n.loadData});return{message:m,...n,...y}}function at(m,u){const[p,n]=J.useState(!1),[y,w]=J.useState({text:"",type:""}),L=(F,a,g=4e3)=>{w({text:F,type:a}),setTimeout(()=>w({text:"",type:""}),g)};return{isUploading:p,message:y,handleFileChange:async F=>{const a=F.target.files[0];if(a){n(!0),L("Uploading and parsing CSV...","info");try{const g=await Ye(a,m);L(`Successfully uploaded ${g} questions!`,"success"),u&&u()}catch(g){L(g.message,"error")}finally{n(!1),F.target.value=null}}}}}function ot({bankId:m,onUploadSuccess:u}){const{isUploading:p,message:n,handleFileChange:y}=at(m,u);return r.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6",children:[r.jsx("input",{type:"file",accept:".csv",onChange:y,disabled:p,className:"mb-4"}),n.text&&r.jsx("div",{className:`mt-4 p-3 rounded ${n.type==="error"?"bg-red-100 text-red-700":n.type==="success"?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"}`,children:n.text}),r.jsxs("div",{className:"text-sm text-gray-600 mt-4",children:[r.jsx("p",{className:"font-semibold mb-2",children:"CSV Format (semicolon-separated):"}),r.jsx("code",{className:"bg-gray-100 p-2 rounded block",children:"question;answerA;answerB;answerC;answerD;correctLetter;duration"}),r.jsxs("p",{className:"mt-2 text-xs",children:["• Use semicolons (;) as delimiters",r.jsx("br",{}),"• duration is in seconds (e.g., 30)",r.jsx("br",{}),"• correctLetter must be A, B, C, or D"]})]})]})}function Ne({title:m,formState:u,onFormStateChange:p,onSubmit:n}){const{question:y,answers:w,correctLetter:L,duration:B}=u,F=g=>{const{name:C,value:q}=g.target;p({...u,[C]:q})},a=(g,C)=>{const q=[...w];q[g]={...q[g],text:C},p({...u,answers:q})};return r.jsx(be,{children:r.jsxs(ke,{className:"p-6",children:[r.jsx(Se,{className:"mb-4",children:m}),r.jsxs("form",{onSubmit:n,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(xe,{htmlFor:"question",children:"Question Text"}),r.jsx(Ee,{type:"text",id:"question",name:"question",value:y,onChange:F,required:!0})]}),r.jsx("div",{className:"grid grid-cols-2 gap-4",children:w.map((g,C)=>r.jsxs("div",{children:[r.jsxs(xe,{htmlFor:`ans-${g.letter}`,children:["Answer ",g.letter]}),r.jsx(Ee,{type:"text",id:`ans-${g.letter}`,value:g.text,onChange:q=>a(C,q.target.value),required:!0})]},g.letter))}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(xe,{htmlFor:"correct",children:"Correct Answer"}),r.jsxs(He,{id:"correct",name:"correctLetter",value:L,onChange:F,children:[r.jsx("option",{value:"A",children:"A"}),r.jsx("option",{value:"B",children:"B"}),r.jsx("option",{value:"C",children:"C"}),r.jsx("option",{value:"D",children:"D"})]})]}),r.jsxs("div",{children:[r.jsx(xe,{htmlFor:"duration",children:"Duration (seconds)"}),r.jsx(Ee,{type:"number",id:"duration",name:"duration",value:B,onChange:F,min:"5",max:"300",required:!0})]})]}),r.jsx(fe,{type:"submit",variant:"primary",className:"w-full",children:m})]})]})})}function lt({questions:m,onEditClick:u,onDeleteClick:p}){return r.jsx(be,{children:r.jsxs(ke,{className:"p-6",children:[r.jsx(Se,{className:"mb-4",children:"All Questions in Bank"}),m.length===0?r.jsx("p",{className:"text-neutral-300 text-center py-4",children:"No questions in this bank yet."}):r.jsx("div",{className:"space-y-4",children:m.map(n=>r.jsxs("div",{className:"border-b border-neutral-700 p-4 flex justify-between items-start hover:bg-neutral-800",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("p",{className:"font-bold text-lg text-neutral-100 mb-2",children:n.question}),r.jsx("ul",{className:"text-sm text-neutral-300 space-y-1",children:n.answers.map(y=>r.jsxs("li",{className:y.letter===n.correctLetter?"font-bold text-primary-light":"",children:[y.letter,": ",y.text]},y.letter))}),r.jsxs("p",{className:"text-xs text-neutral-500 mt-2",children:["Duration: ",n.duration,"s"]})]}),r.jsxs("div",{className:"flex-shrink-0 flex gap-2",children:[r.jsx(fe,{onClick:()=>u(n),variant:"secondary",className:"py-1",children:"Edit"}),r.jsx(fe,{onClick:()=>p(n),variant:"danger",className:"py-1",children:"Delete"})]})]},n.id))})]})})}function ut({isOpen:m,onClose:u,formState:p,onFormStateChange:n,onSubmit:y}){return m?r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:r.jsx(be,{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:r.jsxs(ke,{className:"p-6",children:[r.jsx(Ne,{title:"Edit Question",formState:p,onFormStateChange:n,onSubmit:y}),r.jsx(fe,{type:"button",onClick:u,variant:"secondary",className:"w-full mt-4",children:"Cancel"})]})})}):null}function gt(){const{t:m}=Pe(),{bankId:u,bank:p,questions:n,loading:y,message:w,addFormState:L,setAddFormState:B,handleAddQuestion:F,isEditModalOpen:a,editFormState:g,setEditFormState:C,openEditModal:q,closeEditModal:T,handleUpdateQuestion:z,isDeleteModalOpen:G,questionToDelete:se,openDeleteModal:$,closeDeleteModal:ue,handleDeleteConfirm:ee,handleUploadSuccess:ge}=it();return y?r.jsx($e,{}):p?r.jsxs("div",{children:[r.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsxs("h1",{className:"text-4xl font-display font-bold",children:["Edit: ",p.name]}),r.jsxs("p",{className:"text-neutral-300 mt-2",children:["Total Questions: ",n.length]})]}),r.jsx(qe,{to:"/admin/question-banks",children:r.jsx(fe,{variant:"secondary",children:"← Back to All Banks"})})]}),w.text&&r.jsx("div",{className:`mb-4 p-4 rounded ${w.type==="error"?"bg-secondary":"bg-primary-dark text-white"}`,children:w.text}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8",children:[r.jsx(Ne,{title:"Add New Question",formState:L,onFormStateChange:B,onSubmit:F}),r.jsx(be,{children:r.jsxs(ke,{className:"p-6",children:[r.jsx(Se,{className:"mb-4",children:"Add Questions via CSV"}),r.jsx("p",{className:"text-sm text-neutral-300 mb-4",children:"This will add all questions from the CSV to this existing bank."}),r.jsx(ot,{bankId:u,onUploadSuccess:ge})]})})]}),r.jsx(lt,{questions:n,onEditClick:q,onDeleteClick:$}),r.jsx(We,{isOpen:G,onClose:ue,onConfirm:ee,title:"Delete Question",message:`Are you sure you want to delete this question: "${se?.question}"? This cannot be undone.`,confirmText:"Delete",confirmVariant:"danger"}),r.jsx(ut,{isOpen:a,onClose:T,formState:g,onFormStateChange:C,onSubmit:z})]}):r.jsxs("div",{className:"text-center py-12",children:[r.jsx("h1",{className:"text-2xl font-bold text-secondary mb-4",children:"Error"}),r.jsx("p",{className:"text-neutral-300 mb-6",children:w.text||"Could not load question bank."}),r.jsx(qe,{to:"/admin/question-banks",children:r.jsx(fe,{variant:"secondary",children:"← Back to All Banks"})})]})}export{gt as default};
